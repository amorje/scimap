
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Single-Cell Image Analysis Package">
      
      
        <meta name="author" content="Ajit Johnson Nirmal">
      
      
      
        <link rel="prev" href="../pie/">
      
      
        <link rel="next" href="../../hl/classify/">
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>voronoi - scimap</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-22X9HCL4YP"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-22X9HCL4YP",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-22X9HCL4YP",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scimap.plotting._voronoi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="scimap" class="md-header__button md-logo" aria-label="scimap" data-md-component="logo">
      
  <img src="../../../assets/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            scimap
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              voronoi
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ajitjohnson/scimap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../Getting%20Started/" class="md-tabs__link">
      Getting Started
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../Tools%20Shortcut/" class="md-tabs__link">
      Tools Shortcut
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../pp/mcmicro_to_scimap/" class="md-tabs__link md-tabs__link--active">
        SCIMAP Functions
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../tutorials/1-scimap-tutorial-getting-started/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="scimap" class="md-nav__button md-logo" aria-label="scimap" data-md-component="logo">
      
  <img src="../../../assets/favicon.png" alt="logo">

    </a>
    scimap
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ajitjohnson/scimap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting%20Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools%20Shortcut/" class="md-nav__link">
        Tools Shortcut
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          SCIMAP Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          SCIMAP Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Pre Processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Pre Processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pp/mcmicro_to_scimap/" class="md-nav__link">
        mcmicro_to_scimap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pp/rescale/" class="md-nav__link">
        rescale
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pp/combat/" class="md-nav__link">
        combat
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/phenotype_cells/" class="md-nav__link">
        phenotype_cells
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/cluster/" class="md-nav__link">
        cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/umap/" class="md-nav__link">
        umap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/foldchange/" class="md-nav__link">
        foldchange
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_distance/" class="md-nav__link">
        spatial_distance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_interaction/" class="md-nav__link">
        spatial_interaction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_count/" class="md-nav__link">
        spatial_count
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_lda/" class="md-nav__link">
        spatial_lda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_expression/" class="md-nav__link">
        spatial_expression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_cluster/" class="md-nav__link">
        spatial_cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_pscore/" class="md-nav__link">
        spatial_pscore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_aggregate/" class="md-nav__link">
        spatial_aggregate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tl/spatial_similarity_search/" class="md-nav__link">
        spatial_similarity_search
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          Plotting Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Plotting Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../image_viewer/" class="md-nav__link">
        image_viewer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../addROI_image/" class="md-nav__link">
        addROI_image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gate_finder/" class="md-nav__link">
        gate_finder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../distPlot/" class="md-nav__link">
        distPlot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../densityPlot2D/" class="md-nav__link">
        densityPlot2D
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cluster_plots/" class="md-nav__link">
        cluster_plots
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../umap/" class="md-nav__link">
        umap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../foldchange/" class="md-nav__link">
        foldchange
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spatial_scatterPlot/" class="md-nav__link">
        spatial_scatterPlot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spatial_distance/" class="md-nav__link">
        spatial_distance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spatial_interaction/" class="md-nav__link">
        spatial_interaction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spatial_pscore/" class="md-nav__link">
        spatial_pscore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stacked_barplot/" class="md-nav__link">
        stacked_barplot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pie/" class="md-nav__link">
        pie
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          voronoi
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        voronoi
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scimap.plotting._voronoi" class="md-nav__link">
    scimap.plotting._voronoi
  </a>
  
    <nav class="md-nav" aria-label="scimap.plotting._voronoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scimap.plotting._voronoi--function" class="md-nav__link">
    Function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scimap.plotting._voronoi.voronoi" class="md-nav__link">
    voronoi()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          Helper Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Helper Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hl/classify/" class="md-nav__link">
        classify
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hl/rename/" class="md-nav__link">
        rename
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hl/addROI_omero/" class="md-nav__link">
        addROI_omero
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hl/dropFeatures/" class="md-nav__link">
        dropFeatures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hl/animate/" class="md-nav__link">
        animate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hl/scimap_to_csv/" class="md-nav__link">
        scimap_to_csv
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/1-scimap-tutorial-getting-started/" class="md-nav__link">
        Getting Started with Scimap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/2-scimap-tutorial-cell-phenotyping/" class="md-nav__link">
        Cell-Phenotyping using Scimap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/3-Cell_Type_calling_and_adding_ROIs/" class="md-nav__link">
        Cell-Phenotyping and adding ROIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/4-CellType_Proportion_Exploration/" class="md-nav__link">
        CellType Proportion Exploration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/5-Simple_Spatial_Analysis/" class="md-nav__link">
        Simple Spatial Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/6_animate_with_scimap/" class="md-nav__link">
        Animate with scimap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scimap.plotting._voronoi" class="md-nav__link">
    scimap.plotting._voronoi
  </a>
  
    <nav class="md-nav" aria-label="scimap.plotting._voronoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scimap.plotting._voronoi--function" class="md-nav__link">
    Function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scimap.plotting._voronoi.voronoi" class="md-nav__link">
    voronoi()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>voronoi</h1>

<div class="doc doc-object doc-module">


<a id="scimap.plotting._voronoi"></a>
  <div class="doc doc-contents first">
  
      <p>!!!</p>
<div class="admonition abstract">
<p class="admonition-title">Short Description</p>
<p><code>sm.pl.voronoi</code>: The function allows users to generate a voronoi diagram and color it based on 
any categorical column. Please note, voronoi diagrams are best fitted for small regions with 
upto 5000 cells. Any larger, the voronoi plots are uninterpretable and takes a long time to generate.</p>
</div>
<h5 id="scimap.plotting._voronoi--function">Function</h5>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="scimap.plotting._voronoi.voronoi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">voronoi</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_coordinate</span><span class="o">=</span><span class="s1">&#39;X_centroid&#39;</span><span class="p">,</span> <span class="n">y_coordinate</span><span class="o">=</span><span class="s1">&#39;Y_centroid&#39;</span><span class="p">,</span> <span class="n">imageid</span><span class="o">=</span><span class="s1">&#39;imageid&#39;</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">voronoi_edge_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">voronoi_line_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">voronoi_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">overlay_points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_points_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_drop_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_points_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_point_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">overlay_point_alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overlay_point_shape</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">plot_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>adata</code></td>
          <td>
          </td>
          <td><p>Anndata object</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>color_by</code></td>
          <td>
          </td>
          <td><p>string, optional<br />
Color the voronoi diagram based on categorical variable (e.g. cell types or neighbourhoods).
Pass the name of the column which contains the categorical variable.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>colors</code></td>
          <td>
          </td>
          <td><p>string or Dict, optional<br />
Custom coloring the voronoi diagram. The parameter accepts <code>sns color palettes</code> or a python dictionary
mapping the categorical variable with the required color.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>x_coordinate</code></td>
          <td>
          </td>
          <td><p>float, required<br />
Column name containing the x-coordinates values.</p></td>
          <td>
                <code>&#39;X_centroid&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>y_coordinate</code></td>
          <td>
          </td>
          <td><p>float, required<br />
Column name containing the y-coordinates values.</p></td>
          <td>
                <code>&#39;Y_centroid&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>flip_y</code></td>
          <td>
          </td>
          <td><p>bool, optional<br />
Flip the Y-axis if needed. Some algorithms output the XY with the Y-coordinates flipped.
If the image overlays do not align to the cells, try again by setting this to <code>False</code>.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>imageid</code></td>
          <td>
          </td>
          <td><p>string, optional<br />
Column name of the column containing the image id.</p></td>
          <td>
                <code>&#39;imageid&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>subset</code></td>
          <td>
          </td>
          <td><p>string, optional<br />
imageid of a single image to be subsetted for plotting.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>voronoi_edge_color</code></td>
          <td>
          </td>
          <td><p>string, optional<br />
A Matplotlib color for marking the edges of the voronoi. 
If <code>facecolor</code> is passed, the edge color will always be the same as the face color.</p></td>
          <td>
                <code>&#39;black&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>voronoi_line_width</code></td>
          <td>
          </td>
          <td><p>float, optional<br />
The linewidth of the marker edges. Note: The default edgecolors is 'face'. You may want to change this as well. </p></td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr>
          <td><code>voronoi_alpha</code></td>
          <td>
          </td>
          <td><p>float, optional<br />
The alpha blending value, between 0 (transparent) and 1 (opaque).</p></td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>x_lim</code></td>
          <td>
          </td>
          <td><p>list, optional<br />
Pass the x-coordinates range [x1,x2].</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>y_lim</code></td>
          <td>
          </td>
          <td><p>list, optional<br />
Pass the y-coordinates range [y1,y2].</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_points</code></td>
          <td>
          </td>
          <td><p>string, optional<br />
It is possible to overlay a scatter plot on top of the voronoi diagram.
Pass the name of the column which contains categorical variable to be overlayed.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_points_categories</code></td>
          <td>
          </td>
          <td><p>list, optional<br />
If the passed column in <code>overlay_points</code> contains multiple categories, however the user is only
interested in a subset of categories, those specific names can be passed as a list. By default all 
categories will be overlayed on the voronoi diagram.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_drop_categories</code></td>
          <td>
          </td>
          <td><p>list, optional<br />
Similar to <code>overlay_points_categories</code>. Here for ease of use, especially if large number of categories are present.
The user can drop a set of categories.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_points_colors</code></td>
          <td>
          </td>
          <td><p>string or dict, optional<br />
Similar to <code>colors</code>.<br />
User can pass in a<br />
a) solid color (like <code>black</code>)<br />
b) sns palettes name (like <code>Set1</code>)<br />
c) python dictionary mapping the categories with custom colors</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_point_size</code></td>
          <td>
          </td>
          <td><p>float, optional<br />
Overlay scatter plot point size.</p></td>
          <td>
                <code>5</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_point_alpha</code></td>
          <td>
          </td>
          <td><p>float, optional<br />
The alpha blending value for the overlay, between 0 (transparent) and 1 (opaque).</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>overlay_point_shape</code></td>
          <td>
          </td>
          <td><p>string, optional<br />
The marker style. marker can be either an instance of the class or the text shorthand for a particular marker.</p></td>
          <td>
                <code>&#39;.&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>plot_legend</code></td>
          <td>
          </td>
          <td><p>bool, optional<br />
Define if the figure legend should be plotted.<br />
Please note the figure legend may be out of view and you may need to resize the image to see it, especially 
the legend for the scatter plot which will be on the left side of the plot.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_size</code></td>
          <td>
          </td>
          <td><p>float, optional<br />
Resize the legend if needed.</p></td>
          <td>
                <code>6</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">sm</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">voronoi</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="s1">&#39;phenotype&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
         <span class="n">x_coordinate</span><span class="o">=</span><span class="s1">&#39;X_position&#39;</span><span class="p">,</span> <span class="n">y_coordinate</span><span class="o">=</span><span class="s1">&#39;Y_position&#39;</span><span class="p">,</span>
         <span class="n">imageid</span><span class="o">=</span><span class="s1">&#39;ImageId&#39;</span><span class="p">,</span><span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">voronoi_edge_color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">voronoi_line_width</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> 
         <span class="n">voronoi_alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">size_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
         <span class="n">overlay_points</span><span class="o">=</span><span class="s1">&#39;phenotype&#39;</span><span class="p">,</span> <span class="n">overlay_points_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
         <span class="n">overlay_drop_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">overlay_point_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">overlay_point_alpha</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
         <span class="n">overlay_point_shape</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">plot_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
</details>
      <details class="quote">
        <summary>Source code in <code>scimap/plotting/_voronoi.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">voronoi</span> <span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_coordinate</span><span class="o">=</span><span class="s1">&#39;X_centroid&#39;</span><span class="p">,</span> <span class="n">y_coordinate</span><span class="o">=</span><span class="s1">&#39;Y_centroid&#39;</span><span class="p">,</span>
             <span class="n">imageid</span><span class="o">=</span><span class="s1">&#39;imageid&#39;</span><span class="p">,</span><span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_lim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flip_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">voronoi_edge_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">voronoi_line_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">voronoi_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
             <span class="n">overlay_points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_points_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_drop_categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay_points_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">overlay_point_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">overlay_point_alpha</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">overlay_point_shape</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">plot_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Parameters:</span>
<span class="sd">    adata : Anndata object</span>

<span class="sd">    color_by : string, optional  </span>
<span class="sd">        Color the voronoi diagram based on categorical variable (e.g. cell types or neighbourhoods).</span>
<span class="sd">        Pass the name of the column which contains the categorical variable.</span>

<span class="sd">    colors : string or Dict, optional  </span>
<span class="sd">        Custom coloring the voronoi diagram. The parameter accepts `sns color palettes` or a python dictionary</span>
<span class="sd">        mapping the categorical variable with the required color.</span>

<span class="sd">    x_coordinate : float, required  </span>
<span class="sd">        Column name containing the x-coordinates values.</span>

<span class="sd">    y_coordinate : float, required  </span>
<span class="sd">        Column name containing the y-coordinates values.</span>

<span class="sd">    flip_y : bool, optional  </span>
<span class="sd">        Flip the Y-axis if needed. Some algorithms output the XY with the Y-coordinates flipped.</span>
<span class="sd">        If the image overlays do not align to the cells, try again by setting this to `False`.</span>

<span class="sd">    imageid : string, optional  </span>
<span class="sd">        Column name of the column containing the image id.</span>

<span class="sd">    subset : string, optional  </span>
<span class="sd">        imageid of a single image to be subsetted for plotting.</span>

<span class="sd">    voronoi_edge_color : string, optional  </span>
<span class="sd">        A Matplotlib color for marking the edges of the voronoi. </span>
<span class="sd">        If `facecolor` is passed, the edge color will always be the same as the face color.</span>

<span class="sd">    voronoi_line_width : float, optional  </span>
<span class="sd">        The linewidth of the marker edges. Note: The default edgecolors is &#39;face&#39;. You may want to change this as well. </span>

<span class="sd">    voronoi_alpha : float, optional  </span>
<span class="sd">        The alpha blending value, between 0 (transparent) and 1 (opaque).</span>

<span class="sd">    x_lim : list, optional  </span>
<span class="sd">        Pass the x-coordinates range [x1,x2].</span>

<span class="sd">    y_lim : list, optional  </span>
<span class="sd">        Pass the y-coordinates range [y1,y2].</span>

<span class="sd">    overlay_points : string, optional  </span>
<span class="sd">        It is possible to overlay a scatter plot on top of the voronoi diagram.</span>
<span class="sd">        Pass the name of the column which contains categorical variable to be overlayed.</span>

<span class="sd">    overlay_points_categories : list, optional  </span>
<span class="sd">        If the passed column in `overlay_points` contains multiple categories, however the user is only</span>
<span class="sd">        interested in a subset of categories, those specific names can be passed as a list. By default all </span>
<span class="sd">        categories will be overlayed on the voronoi diagram.</span>

<span class="sd">    overlay_drop_categories : list, optional  </span>
<span class="sd">        Similar to `overlay_points_categories`. Here for ease of use, especially if large number of categories are present.</span>
<span class="sd">        The user can drop a set of categories.</span>

<span class="sd">    overlay_points_colors : string or dict, optional  </span>
<span class="sd">        Similar to `colors`.  </span>
<span class="sd">        User can pass in a  </span>
<span class="sd">        a) solid color (like `black`)  </span>
<span class="sd">        b) sns palettes name (like `Set1`)  </span>
<span class="sd">        c) python dictionary mapping the categories with custom colors</span>

<span class="sd">    overlay_point_size : float, optional  </span>
<span class="sd">        Overlay scatter plot point size.</span>

<span class="sd">    overlay_point_alpha : float, optional  </span>
<span class="sd">        The alpha blending value for the overlay, between 0 (transparent) and 1 (opaque).</span>

<span class="sd">    overlay_point_shape : string, optional  </span>
<span class="sd">        The marker style. marker can be either an instance of the class or the text shorthand for a particular marker.</span>

<span class="sd">    plot_legend : bool, optional  </span>
<span class="sd">        Define if the figure legend should be plotted.  </span>
<span class="sd">        Please note the figure legend may be out of view and you may need to resize the image to see it, especially </span>
<span class="sd">        the legend for the scatter plot which will be on the left side of the plot.</span>

<span class="sd">    legend_size : float, optional  </span>
<span class="sd">        Resize the legend if needed.</span>

<span class="sd">Example:</span>

<span class="sd">    ```python</span>
<span class="sd">    sm.pl.voronoi(adata, color_by=&#39;phenotype&#39;, colors=None, </span>
<span class="sd">             x_coordinate=&#39;X_position&#39;, y_coordinate=&#39;Y_position&#39;,</span>
<span class="sd">             imageid=&#39;ImageId&#39;,subset=None,</span>
<span class="sd">             voronoi_edge_color = &#39;black&#39;,voronoi_line_width = 0.2, </span>
<span class="sd">             voronoi_alpha = 0.5, size_max=np.inf,</span>
<span class="sd">             overlay_points=&#39;phenotype&#39;, overlay_points_categories=None, </span>
<span class="sd">             overlay_drop_categories=None,</span>
<span class="sd">             overlay_point_size = 5, overlay_point_alpha= 1, </span>
<span class="sd">             overlay_point_shape=&quot;.&quot;, plot_legend=False, legend_size=6)</span>

<span class="sd">    ```</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># create the data frame needed</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span>

    <span class="c1"># Subset the image of interest</span>
    <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">imageid</span><span class="p">]</span> <span class="o">==</span> <span class="n">subset</span><span class="p">]</span>


    <span class="c1"># subset coordinates if needed</span>
    <span class="k">if</span> <span class="n">x_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x_lim</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_lim</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x_coordinate</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x_lim</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">y_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">y_lim</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_lim</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">y_coordinate</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="n">y_lim</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># do the actuall subsetting</span>
    <span class="k">if</span> <span class="n">x_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">x_coordinate</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">x1</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">x_coordinate</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">x2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">y_lim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">y_coordinate</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">y1</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">y_coordinate</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">y2</span><span class="p">]</span>


    <span class="c1"># create an extra column with index information</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;index_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># generate the x and y coordinates</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">x_coordinate</span><span class="p">,</span><span class="n">y_coordinate</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># invert the Y-axis</span>
    <span class="k">if</span> <span class="n">flip_y</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Generate colors</span>
    <span class="k">if</span> <span class="n">color_by</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;#e5e5e5&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="c1">#    elif color_by is None and colors is not None:</span>
<span class="c1">#        if isinstance(colors,str):</span>
<span class="c1">#            colors = np.repeat(colors, len(data))</span>
    <span class="k">elif</span> <span class="n">color_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># auto color the samples</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]))</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Set1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]))]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]))</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;tab20&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]))]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="c1"># For large categories generate random colors </span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">])),</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># merge colors with phenotypes/ categories of interest</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">])</span>
        <span class="n">c_p</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="c1"># map to colors</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">c_p</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="n">color_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># check if colors is a dictionary or a sns color scale</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> 
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">colors</span><span class="p">))</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">])):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; includes a maximun of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">colors</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39; colors, while your data need &#39;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">])))</span> <span class="o">+</span> <span class="s1">&#39; colors&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">colors</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]))]</span>    
                <span class="c1"># merge colors with phenotypes/ categories of interest</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">])</span>
                <span class="n">c_p</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">])):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Color mapping is not provided for all categories. Please check&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c_p</span> <span class="o">=</span> <span class="n">colors</span>
        <span class="c1"># map to colors</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">c_p</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">color_by</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>



    <span class="c1"># create the voronoi object</span>
    <span class="n">vor</span> <span class="o">=</span> <span class="n">Voronoi</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="c1"># trim the object</span>
    <span class="n">regions</span><span class="p">,</span> <span class="n">vertices</span> <span class="o">=</span> <span class="n">voronoi_finite_polygons_2d</span><span class="p">(</span><span class="n">vor</span><span class="p">)</span>

    <span class="c1"># plotting</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="n">MultiPoint</span><span class="p">([</span><span class="n">Point</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">points</span><span class="p">])</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">pts</span><span class="o">.</span><span class="n">convex_hull</span>
    <span class="n">new_vertices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">voronoi_alpha</span><span class="p">)</span><span class="o">!=</span><span class="nb">list</span><span class="p">:</span>
        <span class="n">voronoi_alpha</span> <span class="o">=</span> <span class="p">[</span><span class="n">voronoi_alpha</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">region</span><span class="p">,</span><span class="n">alph</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">regions</span><span class="p">,</span><span class="n">voronoi_alpha</span><span class="p">)):</span>
        <span class="n">polygon</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">region</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">shape</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
        <span class="n">areas</span><span class="o">+=</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">area</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">area</span> <span class="o">&lt;</span><span class="n">size_max</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
            <span class="n">new_vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">voronoi_edge_color</span> <span class="o">==</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alph</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="n">voronoi_line_width</span> <span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span> <span class="p">;</span> <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([]);</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alph</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">voronoi_edge_color</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="n">voronoi_line_width</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span> <span class="p">;</span> <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([]);</span>
                <span class="c1">#plt.xlim([1097.5,1414.5])</span>
                <span class="c1">#plt.ylim([167.3,464.1])</span>


    <span class="c1"># Add scatter on top of the voronoi if user requests</span>
    <span class="k">if</span> <span class="n">overlay_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">overlay_points_categories</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="n">overlay_points_categories</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># convert to list if needed (cells to keep)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_points_categories</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> 
                <span class="n">overlay_points_categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">overlay_points_categories</span><span class="p">]</span>
            <span class="c1"># subset cells needed</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">overlay_points_categories</span><span class="p">)]</span>    
        <span class="k">if</span> <span class="n">overlay_drop_categories</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># conver to list if needed (cells to drop)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_drop_categories</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> 
                <span class="n">overlay_drop_categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">overlay_drop_categories</span><span class="p">]</span>
            <span class="c1"># subset cells needed</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">overlay_drop_categories</span><span class="p">)]</span>

        <span class="c1"># Find the x and y coordinates for the overlay category</span>
        <span class="c1">#points_scatter = d[[x_coordinate,y_coordinate]].values</span>
        <span class="n">points_scatter</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">index_info</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

        <span class="c1"># invert the Y-axis</span>
        <span class="c1">#points_scatter[:,1] = max(points_scatter[:,1])-points_scatter[:,1]</span>

        <span class="c1"># Generate colors for the scatter plot</span>
        <span class="k">if</span> <span class="n">overlay_points_colors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color_by</span> <span class="o">==</span> <span class="n">overlay_points</span><span class="p">:</span>
            <span class="c1"># Borrow color from vornoi</span>
            <span class="n">wanted_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])</span> <span class="c1"># The keys to extract</span>
            <span class="n">c_p_scatter</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">c_p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wanted_keys</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">c_p</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">overlay_points_colors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color_by</span> <span class="o">!=</span> <span class="n">overlay_points</span><span class="p">:</span>
            <span class="c1"># Randomly generate colors for all the categories in scatter plot</span>
            <span class="c1"># auto color the samples</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]))</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
                <span class="n">c_scatter</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Set1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]))]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]))</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">:</span>
                <span class="n">c_scatter</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;tab20&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]))]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="c1"># For large categories generate random colors </span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">c_scatter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])),</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="c1"># merge colors with phenotypes/ categories of interest</span>
            <span class="n">p_scatter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])</span>
            <span class="n">c_p_scatter</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_scatter</span><span class="p">,</span> <span class="n">c_scatter</span><span class="p">))</span>
        <span class="k">elif</span>  <span class="n">overlay_points_colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># check if the overlay_points_colors is a pallete</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">c_scatter</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]))]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">))</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; pallete includes a maximun of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39; colors, while your data (overlay_points_colors) need &#39;</span>  <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])))</span> <span class="o">+</span> <span class="s1">&#39; colors&#39;</span><span class="p">)</span> 
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">c_scatter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])))</span>   <span class="c1">#[overlay_points_colors]</span>
                <span class="c1"># create a dict</span>
                <span class="n">p_scatter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])</span>
                <span class="n">c_p_scatter</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_scatter</span><span class="p">,</span> <span class="n">c_scatter</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">overlay_points_colors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">])):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Color mapping is not provided for all categories. Please check overlay_points_colors&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">c_p_scatter</span> <span class="o">=</span> <span class="n">overlay_points_colors</span>
        <span class="c1"># map to colors</span>
        <span class="n">colors_scatter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">c_p_scatter</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">overlay_points</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

        <span class="c1">#plt.scatter(x = points_scatter[:,0], y = points_scatter[:,1], s= overlay_point_size, alpha= overlay_point_alpha, c= colors_scatter, marker=overlay_point_shape)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">points_scatter</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">points_scatter</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span> <span class="n">overlay_point_size</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span> <span class="n">overlay_point_alpha</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span> <span class="n">colors_scatter</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">overlay_point_shape</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span> <span class="p">;</span> <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([]);</span>


    <span class="k">if</span> <span class="n">plot_legend</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Add legend to voronoi</span>
        <span class="n">patchList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">c_p</span><span class="p">:</span>
                <span class="n">data_key</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">c_p</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                <span class="n">patchList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_key</span><span class="p">)</span>

        <span class="n">first_legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patchList</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">legend_size</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="c1"># Add the legend manually to the current Axes.</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">first_legend</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">overlay_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Add legend to scatter</span>
            <span class="n">patchList_scatter</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">c_p_scatter</span><span class="p">:</span>
                    <span class="n">data_key_scatter</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">c_p_scatter</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">patchList_scatter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_key_scatter</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patchList_scatter</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">legend_size</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


  


  



                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://twitter.com/ajitjohnson_n" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>